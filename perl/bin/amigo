#!/usr/bin/perl -w
####
#### TODO: ...
####

## TODO: Think of a way around this preamble.
## Actually, making a perl package might be the best way...
BEGIN { require "config.pl"; }
use lib $ENV{AMIGO_ROOT} . '/perl/lib';

# ## Old URL parameter system.
# use AmiGO::WebApp::HTMLClient;
# my $amigo = AmiGO::WebApp::HTMLClient->new(PARAMS => {});
# $amigo->run();

use AmiGO::WebApp::HTMLClient;
use CGI::Application::Dispatch;

## Remember: even though we use "mode" as our runmode, ir still must
## be declared here as "rm".
my $app = 'AmiGO::WebApp::HTMLClient';
my $dispatch_table =
  [
   ''                  => { app => $app},
   '/'                 => { app => $app},
   'landing'           => { app => $app, rm => 'landing'},
   'search'            => { app => $app, rm => 'search'},
   'simple_search'     => { app => $app, rm => 'simple_search'},
   'browse'            => { app => $app, rm => 'browse'},
   'term/:term'        => { app => $app, rm => 'term', term => 'term'},
   'gene_product/:gp'  => { app => $app, rm => 'gene_product', gp => 'gp'},
   'software_list'     => { app => $app, rm => 'software_list'},
   'visualize'         => { app => $app, rm => 'visualize'},
   'phylo_graph/:gp'  => { app => $app, rm => 'phylo_graph', gp => 'gp'},
  ];
CGI::Application::Dispatch->dispatch(
				     debug => 1,
				     #debug => 0,
				     table => $dispatch_table,
				    );
